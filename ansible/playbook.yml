---
- hosts:
    - master
    - nodes
  strategy: linear
  roles:
    - role: base
    - role: crio
    - role: kubernetes
      become: true

- hosts:
    - master
  serial: 1
  strategy: linear
  vars_files:
    - sizing_vars.yml
  roles:
    - role: cert
    - role: helm
    - role: k8s

- hosts:
    - nodes
  strategy: linear
  vars_files:
    - sizing_vars.yml
  roles:
    - role: k8s

- hosts:
    - master
  serial: 1
  strategy: linear
  run_once: yes
  vars_files:
    - sizing_vars.yml
  roles:
    - role: k8s_postinstall
    - role: ingress
    - role: kubedashboard
    - role: opa

